<!--pages/conversations/conversations.wxml-->
<view style=" overflow-x: hidden; overflow-y: auto; ">
<view class="serach">
<view class="serach_view_show" bindtap="bindtap"> 搜索</view>
</view>
  <view class="message_list">
     <block wx:for="{{conversations}}">
          <view class="item" bindtap="goChat" data-item="{{item}}"
          data-conId="{{item.conversation.conId}}"
          bindlongpress="handleLongPress" >
             <view class="item-left">
                  <image src="{{item.conUrl}}" class="image"/>
             </view>
             <view class="item-middle">
                  <view>
                      <text class="title"
                      wx:if="{{item.conversation.conAiNotes!=null&&item.conversation.conAiNotes!=''}}">{{item.conversation.conAiNotes}}</text>
                       <text wx:else 
                       class="title">{{item.conversation.conAiName}}</text>
                  </view>
                  <view>
                      <text wx:if="{{item.conversation.lastMessage!=null}}" class="message">{{item.conversation.lastMessage}}</text>
                  </view>
            </view>
            <view class="item_right">
                <view class="time-wrap">
                <text class="time" wx:if="{{item.conversation.lastMessageTime!=null}}">{{item.conversation.lastMessageTime}}</text>
                <text class='time' wx:else>
                {{formatTime(item.conversation.conCreatedTime)}}
                </text>
                </view>
                <view class="mark" wx:if="{{1}}"><text class="text">{{1}}</text></view>
            </view>
         </view>
         <view  class="line"></view>
    </block>
  </view>
</view>
<view class="addConversation">
        <image class="add" src="/images/add.png" 
        bindtap="openModal"/>
</view>
<!-- 弹窗组件 -->
<view class="modal-mask" wx:if="{{showModal}}">
  <view class="modal-content" catchtap="stopPropagation">
    <!-- 标题 -->
    <view class="modal-header">
      <text class="modal-title">机器人设置</text>
    </view>

    <!-- 名称 -->
    <view class="form-item">
      <text class="label">名称</text>
      <text class="fixed-value">{{newAiName}}</text>
    </view>

    <!-- 备注 -->
    <view class="form-item">
      <text class="label">备注</text>
      <input 
        class="input" 
        placeholder="请输入备注" 
        value="{{remark}}" 
        bindinput="onInputRemark"
      />
    </view>

    <!-- 对话风格 -->
    <view class="form-item">
      <text class="label">对话风格</text>
      <picker 
        class="picker" 
        range="{{styles}}" 
        value="{{styleIndex}}"
        bindchange="onStyleChange"
      >
        <view class="picker-content">
          {{styles[styleIndex]}}
          <image class="arrow" src="/images/arrow-right.png" />
        </view>
      </picker>
    </view>

    <!-- 按钮 -->
    <view class="modal-buttons">
      <button class="back-btn" bindtap="back">取消</button>
    <button class="confirm-btn" bindtap="confirmSettings">确认</button>
    </view>
  </view>
</view>